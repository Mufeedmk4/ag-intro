pdf('RAP1_IAA_30M_REP1.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,59,60,63,64,67,78,79,81,82,85,90,97,98,125)
seq_uniqRead=c(22378,6369,1774,1202,729,565,395,348,285,197,201,144,121,104,87,84,60,75,46,40,35,40,23,27,39,23,26,15,9,14,15,14,12,10,10,10,9,6,8,7,4,5,3,3,4,4,2,2,3,6,5,3,1,1,3,2,2,2,1,2,1,1,1,1,1,2,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,59,60,61,63,64,67,68,69,70,82,83,84,85,86,87,90,95,96,101,106,110,136)
pos_uniqRead=c(14697,5833,1586,1177,714,562,417,347,278,239,203,176,151,119,107,67,88,83,72,48,60,42,36,37,39,27,28,32,19,27,17,15,18,11,12,10,6,17,9,9,8,11,4,14,11,6,6,3,2,3,7,2,3,3,5,2,4,3,4,3,4,3,1,1,1,1,3,1,1,1,1,1,2,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
