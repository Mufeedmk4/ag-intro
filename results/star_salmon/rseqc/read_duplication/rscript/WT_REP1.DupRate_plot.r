pdf('WT_REP1.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,97,99,100,101,102,103,104,105,106,109,111,112,113,114,115,116,118,119,120,124,126,130,132,136,139,145,147,149,153,155,163,170,191,205,241,245,296,325,360)
seq_uniqRead=c(33628,10043,2337,1829,1004,846,635,543,394,381,300,231,205,182,165,172,123,121,108,104,89,77,87,66,74,62,63,44,44,36,38,47,32,38,29,30,21,29,30,23,25,21,21,16,18,13,16,17,16,18,10,13,7,9,8,7,9,5,4,6,10,6,5,13,5,3,5,12,12,3,7,5,4,5,5,3,3,1,4,2,1,2,1,4,1,4,2,1,4,1,3,2,2,2,1,2,4,1,2,1,1,2,1,1,2,1,3,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,109,110,111,112,113,114,115,117,118,120,122,123,124,125,127,128,129,130,131,133,136,137,139,141,144,148,150,151,158,160,161,164,167,171,173,176,179,180,184,213,216,239,260,280,321,356,381)
pos_uniqRead=c(19066,9045,2021,1661,924,795,564,483,399,356,291,246,210,209,155,159,153,127,130,108,100,73,88,69,82,58,79,67,46,45,48,47,32,40,34,44,39,39,25,29,26,26,30,24,25,20,14,20,14,14,18,31,15,15,8,15,13,14,12,12,11,9,1,9,4,6,9,8,12,4,8,4,8,9,4,7,6,4,2,8,3,5,4,3,3,3,7,2,3,5,4,5,5,1,4,1,4,3,3,3,2,2,1,3,2,2,2,2,2,1,1,1,1,2,1,1,2,1,1,2,2,1,2,2,2,1,3,2,1,1,1,1,2,2,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
